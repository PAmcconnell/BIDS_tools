2023-11-04 22:24:08,461 - INFO - Starting main processing function.
2023-11-04 22:24:08,461 - INFO - Subject ID: sub-LRN001, Session ID: ses-1
2023-11-04 22:24:08,461 - INFO - Processing subject: sub-LRN001, session: ses-1
2023-11-04 22:24:08,462 - INFO - Loading MAT file from /Users/PAM201/Documents/MRI/LEARN/BIDS_test/sourcedata/sub-LRN001/ses-1/physio/sub-LRN001_ses-1_task-rest_physio.mat
2023-11-04 22:24:08,820 - INFO - Labels extracted from MAT file: ['ECG Test - ECG100C' 'RSP Test - RSP100C' 'EDA - EDA100C-MRI'
 'MRI Trigger - Custom, HLT100C - A 4' 'Digital input' 'Digital input'
 'Digital input' 'Digital input' 'Digital input' 'Digital input'
 'Digital input' 'Digital input']
2023-11-04 22:24:08,820 - INFO - Units extracted from MAT file: ['mV' 'Volts' 'microsiemens' 'Volts' 'Volts' 'Volts' 'Volts' 'Volts'
 'Volts' 'Volts' 'Volts' 'Volts']
2023-11-04 22:24:08,820 - INFO - Successfully loaded MAT file from /Users/PAM201/Documents/MRI/LEARN/BIDS_test/sourcedata/sub-LRN001/ses-1/physio/sub-LRN001_ses-1_task-rest_physio.mat
2023-11-04 22:24:08,820 - INFO - Data loaded successfully with shape: (21203169, 12)
2023-11-04 22:24:08,820 - INFO - Physiological data loaded successfully.
2023-11-04 22:24:08,820 - INFO - Renaming channels according to BIDS conventions
2023-11-04 22:24:08,820 - INFO - BIDS labels dictionary mapping: {'ECG Test - ECG100C': 'cardiac', 'RSP Test - RSP100C': 'respiratory', 'EDA - EDA100C-MRI': 'eda', 'MRI Trigger - Custom, HLT100C - A 4': 'trigger'}
2023-11-04 22:24:08,820 - INFO - BIDS labels list after renaming: ['cardiac', 'respiratory', 'eda', 'trigger']
2023-11-04 22:24:08,820 - INFO - BIDS Labels: ['cardiac', 'respiratory', 'eda', 'trigger']
2023-11-04 22:24:08,820 - INFO - Channels renamed according to BIDS format and units dictionary created.
2023-11-04 22:24:08,820 - INFO - Extracting metadata from /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-01_bold.json
2023-11-04 22:24:08,820 - INFO - Metadata for run run-01 extracted successfully.
2023-11-04 22:24:08,820 - INFO - JSON file path: /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-01_bold.json
2023-11-04 22:24:08,820 - INFO - Repetition time: 2
2023-11-04 22:24:08,820 - INFO - Number of volumes per run: 175
2023-11-04 22:24:08,907 - INFO - Run found from index 8695841 to 10445841
2023-11-04 22:24:08,907 - INFO - Run found from index 10509314 to 12259314
2023-11-04 22:24:08,907 - INFO - Run found from index 12480866 to 14230866
2023-11-04 22:24:08,907 - INFO - Run found from index 14294290 to 16044290
2023-11-04 22:24:08,907 - INFO - Runs identified for run-01 of 4 runs
2023-11-04 22:24:16,154 - INFO - Output files for run run-01 written successfully to /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func
2023-11-04 22:24:16,156 - INFO - Output files for run run-01 written successfully.
2023-11-04 22:24:16,156 - INFO - Extracting metadata from /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-02_bold.json
2023-11-04 22:24:16,157 - INFO - Metadata for run run-02 extracted successfully.
2023-11-04 22:24:16,157 - INFO - JSON file path: /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-02_bold.json
2023-11-04 22:24:16,157 - INFO - Repetition time: 2
2023-11-04 22:24:16,157 - INFO - Number of volumes per run: 175
2023-11-04 22:24:16,212 - INFO - Run found from index 8695841 to 10445841
2023-11-04 22:24:16,212 - INFO - Run found from index 10509314 to 12259314
2023-11-04 22:24:16,212 - INFO - Run found from index 12480866 to 14230866
2023-11-04 22:24:16,212 - INFO - Run found from index 14294290 to 16044290
2023-11-04 22:24:16,212 - INFO - Runs identified for run-02 of 4 runs
2023-11-04 22:24:23,352 - INFO - Output files for run run-02 written successfully to /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func
2023-11-04 22:24:23,354 - INFO - Output files for run run-02 written successfully.
2023-11-04 22:24:23,354 - INFO - Extracting metadata from /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-03_bold.json
2023-11-04 22:24:23,354 - INFO - Metadata for run run-03 extracted successfully.
2023-11-04 22:24:23,354 - INFO - JSON file path: /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-03_bold.json
2023-11-04 22:24:23,354 - INFO - Repetition time: 2
2023-11-04 22:24:23,354 - INFO - Number of volumes per run: 175
2023-11-04 22:24:23,412 - INFO - Run found from index 8695841 to 10445841
2023-11-04 22:24:23,412 - INFO - Run found from index 10509314 to 12259314
2023-11-04 22:24:23,412 - INFO - Run found from index 12480866 to 14230866
2023-11-04 22:24:23,412 - INFO - Run found from index 14294290 to 16044290
2023-11-04 22:24:23,412 - INFO - Runs identified for run-03 of 4 runs
2023-11-04 22:24:30,546 - INFO - Output files for run run-03 written successfully to /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func
2023-11-04 22:24:30,549 - INFO - Output files for run run-03 written successfully.
2023-11-04 22:24:30,549 - INFO - Extracting metadata from /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-04_bold.json
2023-11-04 22:24:30,549 - INFO - Metadata for run run-04 extracted successfully.
2023-11-04 22:24:30,549 - INFO - JSON file path: /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func/sub-LRN001_ses-1_task-rest_run-04_bold.json
2023-11-04 22:24:30,549 - INFO - Repetition time: 2
2023-11-04 22:24:30,549 - INFO - Number of volumes per run: 175
2023-11-04 22:24:30,607 - INFO - Run found from index 8695841 to 10445841
2023-11-04 22:24:30,607 - INFO - Run found from index 10509314 to 12259314
2023-11-04 22:24:30,607 - INFO - Run found from index 12480866 to 14230866
2023-11-04 22:24:30,608 - INFO - Run found from index 14294290 to 16044290
2023-11-04 22:24:30,608 - INFO - Runs identified for run-04 of 4 runs
2023-11-04 22:24:37,731 - INFO - Output files for run run-04 written successfully to /Users/PAM201/Documents/MRI/LEARN/BIDS_test/dataset/sub-LRN001/ses-1/func
2023-11-04 22:24:37,734 - INFO - Output files for run run-04 written successfully.
2023-11-04 22:24:37,734 - INFO - Full dataset shape: (21203169, 12)
2023-11-04 22:24:37,734 - INFO - Number of runs to plot: 16
2023-11-04 22:24:37,734 - INFO - Original labels being passed to plot_runs: ['ECG Test - ECG100C' 'RSP Test - RSP100C' 'EDA - EDA100C-MRI'
 'MRI Trigger - Custom, HLT100C - A 4' 'Digital input' 'Digital input'
 'Digital input' 'Digital input' 'Digital input' 'Digital input'
 'Digital input' 'Digital input']
2023-11-04 22:24:37,734 - INFO - BIDS labels being passed to plot_runs: ['cardiac', 'respiratory', 'eda', 'trigger']
2023-11-04 22:24:37,734 - INFO - Run 1 start index: 8695841, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 2 start index: 10509314, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 3 start index: 12480866, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 4 start index: 14294290, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 5 start index: 8695841, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 6 start index: 10509314, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 7 start index: 12480866, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 8 start index: 14294290, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 9 start index: 8695841, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 10 start index: 10509314, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 11 start index: 12480866, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 12 start index: 14294290, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 13 start index: 8695841, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 14 start index: 10509314, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 15 start index: 12480866, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - INFO - Run 16 start index: 14294290, data shape: (1750000, 12)
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 8695841 and will be ignored.
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 10509314 and will be ignored.
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 12480866 and will be ignored.
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 14294290 and will be ignored.
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 8695841 and will be ignored.
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 10509314 and will be ignored.
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 12480866 and will be ignored.
2023-11-04 22:24:37,734 - WARNING - Duplicate run detected at start index 14294290 and will be ignored.
2023-11-04 22:24:37,735 - WARNING - Duplicate run detected at start index 8695841 and will be ignored.
2023-11-04 22:24:37,735 - WARNING - Duplicate run detected at start index 10509314 and will be ignored.
2023-11-04 22:24:37,735 - WARNING - Duplicate run detected at start index 12480866 and will be ignored.
2023-11-04 22:24:37,735 - WARNING - Duplicate run detected at start index 14294290 and will be ignored.
2023-11-04 22:24:37,735 - INFO - Number of unique runs to plot after deduplication: 4
2023-11-04 22:24:37,735 - INFO - Runs info before plotting: [{'data': array([[-0.47790527,  0.15228271, 14.10827534, ...,  0.        ,
         0.        ,  0.        ],
       [-0.50720215,  0.15228271, 14.10369771, ...,  0.        ,
         0.        ,  0.        ],
       [-0.53833008,  0.15258789, 14.10827534, ...,  0.        ,
         0.        ,  0.        ],
       ...,
       [-0.42358398,  0.10894775, 10.53008931, ...,  0.        ,
         0.        ,  0.        ],
       [-0.42236328,  0.10925293, 10.52551167, ...,  0.        ,
         0.        ,  0.        ],
       [-0.41992188,  0.10986328, 10.53008931, ...,  0.        ,
         0.        ,  0.        ]]), 'start_index': 8695841, 'end_index': 10445841}, {'data': array([[-0.16052246, -0.40893555, 10.68878071, ...,  0.        ,
         0.        ,  0.        ],
       [-0.19104004, -0.40771484, 10.68572896, ...,  0.        ,
         0.        ,  0.        ],
       [-0.21911621, -0.40924072, 10.68572896, ...,  0.        ,
         0.        ,  0.        ],
       ...,
       [-0.32043457, -0.06713867,  9.10034077, ...,  0.        ,
         0.        ,  0.        ],
       [-0.32104492, -0.06744385,  9.10034077, ...,  0.        ,
         0.        ,  0.        ],
       [-0.32348633, -0.06744385,  9.10644429, ...,  0.        ,
         0.        ,  0.        ]]), 'start_index': 10509314, 'end_index': 12259314}, {'data': array([[ 4.70581055e-01, -1.28173828e-02,  1.40655507e+01, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [ 4.41284180e-01, -1.25122070e-02,  1.40655507e+01, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [ 4.10766602e-01, -1.19018555e-02,  1.40640249e+01, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       ...,
       [-7.93457031e-03, -3.91540527e-01,  9.73205464e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [-7.32421875e-03, -3.92150879e-01,  9.73052876e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [-7.32421875e-03, -3.92761230e-01,  9.73205464e+00, ...,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00]]), 'start_index': 12480866, 'end_index': 14230866}, {'data': array([[-0.02929688,  0.34332275,  9.63745015, ...,  0.        ,
         0.        ,  0.        ],
       [-0.06469727,  0.34301758,  9.64202778, ...,  0.        ,
         0.        ,  0.        ],
       [-0.0970459 ,  0.34240723,  9.64050191, ...,  0.        ,
         0.        ,  0.        ],
       ...,
       [-0.46875   ,  0.09124756,  8.28399556, ...,  0.        ,
         0.        ,  0.        ],
       [-0.47180176,  0.09094238,  8.27941792, ...,  0.        ,
         0.        ,  0.        ],
       [-0.47302246,  0.09094238,  8.27941792, ...,  0.        ,
         0.        ,  0.        ]]), 'start_index': 14294290, 'end_index': 16044290}]
2023-11-04 22:24:37,735 - ERROR - An error occurred during the main processing
Traceback (most recent call last):
  File "/Users/PAM201/Documents/MATLAB/software/iNR/BIDS_tools/process_physio_ses_1.py", line 559, in main
    if not data or not all([run.size > 0 for run in data]):
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2023-11-04 22:24:37,735 - ERROR - Processing terminated due to an unexpected error.
